package br.com.pagga.chamado.service;

import java.util.List;

import javax.inject.Inject;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import br.com.pagga.chamado.dao.PerfilRotinaAtributoDAO;
import br.com.pagga.chamado.model.Perfil;
import br.com.pagga.chamado.model.PerfilRotinaAtributo;

public class PerfilRotinaAtributoService {
	
	private PerfilRotinaAtributoDAO perfilRotinaAtributoDAO;
	
	private static final Logger logger = LoggerFactory.getLogger(PerfilRotinaAtributoService.class);
	
	public PerfilRotinaAtributoService() {
	}
	
	@Inject
	public PerfilRotinaAtributoService(PerfilRotinaAtributoDAO perfilRotinaAtributoDAO) {
		this.perfilRotinaAtributoDAO = perfilRotinaAtributoDAO;
	}
	
	public List<PerfilRotinaAtributo> buscaPerfilRotinaAtributo(){
		List<PerfilRotinaAtributo> list = perfilRotinaAtributoDAO.findAll();
		return list;
	}
	
	public void cadastrarPerfilRotinaAtributo(PerfilRotinaAtributo perfilRotinaAtributo) {
		try {
			perfilRotinaAtributoDAO.save(perfilRotinaAtributo);
			logger.info("Perfil ID= {} Rotina ID= {} e Atributo  ID= {} vinculados", 
					perfilRotinaAtributo.getPerfil().getId(), perfilRotinaAtributo.getRotina().getId(),
					perfilRotinaAtributo.getAtributo().getId());
		} catch (Exception e) {
			logger.error("Erro ao vincular o perfil a rotina!", e.getMessage());
		}
	}
	
	public void removerPerfilRotinaAtributo(PerfilRotinaAtributo perfilRotinaAtributo) {
		try {
			logger.info("Perfil-Rotina-Atributo ID = {} removido", 
					perfilRotinaAtributo.getId());
			perfilRotinaAtributoDAO.removeById(perfilRotinaAtributo.getId());
		} catch (Exception e) {
			logger.error("Erro ao excluir o Perfil-Rotina-Atributo!", e.getMessage());
		}
		
	}
	
	public void removerTodasAsRotinasDoPerfil( Perfil perfil ) {
		try {
			perfilRotinaAtributoDAO.removeByPerfil(perfil);
			logger.info("Perfil {} esta sendo excluido, e todas os vinculos estão sendo deletados", 
					perfil.getDescricao());
		} catch (Exception e) {
			logger.error("Erro ao desvincular o perfil e rotina!", e.getMessage());
		}
		
	}
	
}
